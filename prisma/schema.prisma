generator client {
  provider = "prisma-client-js"
}

datasource postgresql {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model flyway_schema_history {
  installed_rank Int      @id
  version        String?
  description    String
  type           String
  script         String
  checksum       Int?
  installed_by   String
  installed_on   DateTime @default(now())
  execution_time Int
  success        Boolean

  @@index([success], name: "flyway_schema_history_s_idx")
}

model Member {
  id                Int       @id @default(autoincrement())
  givenName         String?   @map("given_name")
  familyName        String?   @map("family_name")
  gender            String?
  dob               DateTime?
  registration_date DateTime?

  @@map("member")
}

model News {
  id          Int             @id @default(autoincrement())
  createdDate DateTime        @map("created_date")
  publishDate DateTime        @map("publish_date")
  title       String
  body        String
  attributes  NewsAttribute[]
  comments    NewsComment[]

  @@map("news")
}

model NewsAttribute {
  id     Int     @id @default(autoincrement())
  newsId Int     @map("news_id")
  name   String
  value  String?
  news   News    @relation(fields: [newsId], references: [id])

  @@index([newsId], name: "idx_news_attribute_news_id")
  @@map("news_attribute")
}

model NewsComment {
  id     Int     @id @default(autoincrement())
  newsId Int     @map("news_id")
  author String?
  body   String
  news   News    @relation(fields: [newsId], references: [id])

  @@index([newsId], name: "idx_news_comment_news_id")
  @@map("news_comment")
}

model User {
  id         Int     @id @default(autoincrement())
  externalId String? @unique @map("external_id")
  email      String  @unique
  givenName  String? @map("given_name")
  familyName String? @map("family_name")
  roles      Json

  @@map("user")
}
